<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}AI Content Studio{% endblock %}</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Custom styles (με theme variables) -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body>
  <header class="border-bottom">
    <nav class="navbar navbar-expand-lg px-3">
      <a class="navbar-brand fw-bold" href="{{ url_for('index') }}">AI Content Studio</a>

      <div class="ms-auto d-flex align-items-center gap-2">
        <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('index') }}">Home</a>
        <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('gallery') }}">Gallery</a>
        <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('logs') }}">Logs</a>
        <a class="btn btn-sm btn-outline-primary"  href="{{ url_for('backup') }}">Backup (ZIP)</a>

        <!-- Theme switcher -->
        <div class="d-flex align-items-center ms-2">
          <label for="themeSelect" class="me-2 small m-0">Theme</label>
          <select id="themeSelect" class="form-select form-select-sm" style="width:150px">
            <option value="auto">Auto (System)</option>
            <option value="light">Light</option>
            <option value="dark">Dark</option>
          </select>
        </div>
      </div>
    </nav>
  </header>

  <main>
    {% block content %}{% endblock %}
  </main>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Theme logic -->
  <script>
    (function() {
      const KEY  = 'acs_theme';
      const root = document.documentElement;
      const sel  = document.getElementById('themeSelect');

      function applyTheme(mode) {
        if (mode === 'light') {
          root.setAttribute('data-theme', 'light');
        } else if (mode === 'dark') {
          root.setAttribute('data-theme', 'dark');
        } else {
          root.removeAttribute('data-theme'); // Auto: αφήνουμε το system @media να αποφασίσει
        }
      }
      function loadTheme() {
        const saved = localStorage.getItem(KEY) || 'auto';
        if (sel) sel.value = saved;
        applyTheme(saved);
      }
      if (sel) {
        sel.addEventListener('change', () => {
          const val = sel.value;
          localStorage.setItem(KEY, val);
          applyTheme(val);
        });
      }
      const mql = window.matchMedia('(prefers-color-scheme: dark)');
      mql?.addEventListener?.('change', () => {
        if ((localStorage.getItem(KEY) || 'auto') === 'auto') applyTheme('auto');
      });
      document.addEventListener('DOMContentLoaded', loadTheme);
    })();
  </script>
</body>
</html>
