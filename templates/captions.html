{% extends "base.html" %}
{% block content %}
<div class="container" style="margin-top:40px; max-width: 980px;">
  <h2>âœï¸ Captions / Hook / CTA Î±Î½Î¬ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±</h2>
  <p class="text-muted">Î”ÏÏƒÎµ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î± Ï€ÏÎ¿ÏŠÏŒÎ½Ï„Î¿Ï‚ & ÎµÏ€Î¯Î»ÎµÎ¾Îµ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î±. Î˜Î± Ï€Î±ÏÎ±Ï‡Î¸Î¿ÏÎ½ Hook, Caption, CTA & Hashtags (GR/EN).</p>

  <form method="post" class="mt-3" id="capForm">
    <div class="row g-2">
      <div class="col-md-6">
        <label class="form-label">Î Î»Î±Ï„Ï†ÏŒÏÎ¼Î±</label>
        <select class="form-select" name="platform" required>
          <option value="instagram" selected>Instagram</option>
          <option value="tiktok">TikTok</option>
          <option value="facebook">Facebook</option>
          <option value="pinterest">Pinterest</option>
          <option value="youtube">YouTube</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">Î“Î»ÏÏƒÏƒÎ±</label>
        <select class="form-select" name="lang" required>
          <option value="el" selected>Î•Î»Î»Î·Î½Î¹ÎºÎ¬</option>
          <option value="en">English</option>
          <option value="el+en">Î”Î¯Î³Î»Ï‰ÏƒÏƒÎ¿ (GR+EN)</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">ÎÏ†Î¿Ï‚</label>
        <select class="form-select" name="tone" required>
          <option value="friendly" selected>Friendly</option>
          <option value="energetic">Energetic</option>
          <option value="minimal">Minimal</option>
          <option value="premium">Premium</option>
        </select>
      </div>
    </div>

    <div class="row g-2 mt-2">
      <div class="col-md-6">
        <label class="form-label">Brand / Model</label>
        <input type="text" class="form-control" name="product" placeholder="Ï€.Ï‡. adidas Adizero Evo SL" required>
      </div>
      <div class="col-md-6">
        <label class="form-label">USP / Î›ÎµÏ€Ï„Î¿Î¼Î­ÏÎµÎ¹ÎµÏ‚</label>
        <input type="text" class="form-control" name="details" placeholder="Ï€.Ï‡. super-light, responsive foam, race-day">
        <small class="text-muted">USP = Unique Selling Points (ÏŒ,Ï„Î¹ Ï„Î¿ ÎºÎ¬Î½ÎµÎ¹ Î½Î± Î¾ÎµÏ‡Ï‰ÏÎ¯Î¶ÎµÎ¹)</small>
      </div>
    </div>

    <div class="row g-2 mt-2">
      <div class="col-md-6">
        <label class="form-label">Target / Season</label>
        <input type="text" class="form-control" name="audience" placeholder="Ï€.Ï‡. runners, marathon prep, autumn">
        <small class="text-muted">Î£Îµ Ï€Î¿Î¹Î¿Ï…Ï‚ Î¼Î¹Î»Î¬Î¼Îµ & Î³Î¹Î± Ï€Î¿Î¹Î± Ï€ÎµÏÎ¯ÏƒÏ„Î±ÏƒÎ·/ÏƒÎµÎ¶ÏŒÎ½</small>
      </div>
      <div class="col-md-3">
        <label class="form-label">#Hashtags</label>
        <input type="number" class="form-control" name="num_hashtags" value="8" min="0" max="20">
      </div>
      <div class="col-md-3 d-flex align-items-end">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="use_emojis" value="1" checked id="emChk">
          <label class="form-check-label" for="emChk">Emojis</label>
        </div>
      </div>
    </div>

    <div class="mt-2">
      <label class="form-label">Extra Î¿Î´Î·Î³Î¯ÎµÏ‚ (optional)</label>
      <textarea class="form-control" name="extra" rows="2" placeholder="Ï€.Ï‡. Î²Î¬Î»Îµ call-out Î³Î¹Î± -10% Î¼Îµ ÎºÏ‰Î´Î¹ÎºÏŒ SNEAK10"></textarea>
    </div>

    <button class="btn btn-primary mt-3" type="submit" id="genBtn">Generate Captions</button>
    <a class="btn btn-secondary mt-3" href="{{ url_for('logs') }}">ğŸ§¾ Logs</a>
  </form>

  {% if result %}
  <hr class="my-4">
  <h5>Î‘Ï€Î¿Ï„Î­Î»ÎµÏƒÎ¼Î±</h5>

  <div class="card mb-3">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center">
        <h6 class="mb-0">Hook</h6>
        <button class="btn btn-sm btn-outline-secondary" onclick="copyById('resultHook')">Copy</button>
      </div>
      <pre id="resultHook" class="mt-2" style="white-space:pre-wrap">{{ result.hook }}</pre>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center">
        <h6 class="mb-0">Caption</h6>
        <button class="btn btn-sm btn-outline-secondary" onclick="copyById('resultCaption')">Copy</button>
      </div>
      <pre id="resultCaption" class="mt-2" style="white-space:pre-wrap">{{ result.caption }}</pre>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center">
        <h6 class="mb-0">CTA</h6>
        <button class="btn btn-sm btn-outline-secondary" onclick="copyById('resultCTA')">Copy</button>
      </div>
      <pre id="resultCTA" class="mt-2" style="white-space:pre-wrap">{{ result.cta }}</pre>
    </div>
  </div>

  {% if result.hashtags %}
  <div class="card mb-3">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center">
        <h6 class="mb-0">Hashtags</h6>
        <button class="btn btn-sm btn-outline-secondary" onclick="copyById('resultTags')">Copy</button>
      </div>
      <pre id="resultTags" class="mt-2" style="white-space:pre-wrap">{{ result.hashtags|join(' ') }}</pre>
    </div>
  </div>
  {% endif %}

  <div class="d-flex gap-2">
    <button class="btn btn-outline-secondary" onclick="copyAll()">ğŸ“‹ Copy All</button>
  </div>
  {% endif %}
</div>

<script>
function copyById(id) {
  const el = document.getElementById(id);
  if (!el) return alert('Nothing to copy.');
  const text = el.innerText || el.textContent || '';
  navigator.clipboard.writeText(text.trim());
  alert('Copied âœ“');
}
function copyAll() {
  const ids = ['resultHook','resultCaption','resultCTA','resultTags'];
  let text = '';
  ids.forEach(id => {
    const el = document.getElementById(id);
    if (el) text += el.innerText + '\n\n';
  });
  navigator.clipboard.writeText(text.trim());
  alert('All copied âœ“');
}
</script>
{% endblock %}
